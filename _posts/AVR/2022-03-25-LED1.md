---
layout: single
title: "[ATmega128]LED 점등"
categories: ["AVR"]
tag: [ATmega128]
author_profile: true
sidebar_main: true
---

> **개요**

가장 간단한 LED를 제어해보도록 한다. LED를 제어하는 것은 매우 쉬워보이나 동작되는 과정들을 확실히 이해하기 위해선 많은 배경 지식이 필요해보인다. LED 점등 과정을 몇 단계를 거쳐 천천히 하나씩 공부해보도록 하자!

> **하드웨어 구성**

> **소스코드**

LED 한 개를 점등하는 소스코드의 전체적인 구성은 이렇다. 하나하나씩 살펴보도록 하자.
```cpp
#define F_CPU 16000000UL
#include <avr/io.h>
#include <util/delay.h>

int main(void)
{
	DDRB = 0x01;
	while (1)
	{
		PORTB = 0x01;
		_delay_ms(500);
		PORTB = 0x00;
		_delay_ms(500);
	}
}
```

> **소스코드 구성**

```cpp
#define F_CPU 16000000UL
#include <avr/io.h>
#include <util/delay.h>
```
```#define F_CPU```로 AVR CPU의 동작 클럭을 설정한다. ATmega128은 초기 동작 클럭이 16MHz로 설정되어 있으므로 16000000으로 설정 해주었고, UL은 프로그래밍 단위로 unsigend long을 의미한다.


```#include <avr/io.h>``` ```#include <util/delay.h```와 같은 .h는 헤더 파일을 포함시킨다는 뜻이다. 즉, 이미 만들어진 명령어들을 사용하는 것이다. <**avr/io.h**>는 input/output 명령어, <**util/delay.h**>는 time delay 명령어가 있다.

```cpp
	DDRB = 0x01;
```
**DDRx**는 입출력 방향을 지정해주는 레지스터이다. 0x01은 16진수로 0b00000001을 뜻하고 각각의 위치는 0~7번 핀을 뜻한다. 즉, B포트의 0번 핀을 출력으로 설정해주었다.

```CPP
	while (1)
	{
		PORTB = 0x01;
		_delay_ms(500);
		PORTB = 0x00;
		_delay_ms(500);
	}
```

**PORTx**는 출력 설정 시 출력 값을 지정해주는 레지스터이다. 소스코드를 해석하면 B포트의 0번 핀을 HIGH(5V)로 설정하고 0.5초 동안 유지 후 0번 핀을 LOW(0V)로 설정한 후 0.5초간 유지를 반복하는 것이다.
